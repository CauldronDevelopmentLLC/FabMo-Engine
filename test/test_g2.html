<!DOCTYPE html><html lang="en"><head><title>test/test_g2</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../"><meta name="groc-document-path" content="test/test_g2"><meta name="groc-project-path" content="test/test_g2.js"><link rel="stylesheet" type="text/css" media="all" href="../assets/style.css"><script type="text/javascript" src="../assets/behavior.js"></script><body><div id="meta"><div class="file-path">test/test_g2.js</div></div><div id="document"><div class="segment"><div class="code"><div class="wrapper"><span class="hljs-keyword">var</span> assert = <span class="hljs-built_in">require</span>(<span class="hljs-string">"assert"</span>);
<span class="hljs-keyword">var</span> async = <span class="hljs-built_in">require</span>(<span class="hljs-string">"async"</span>)
<span class="hljs-keyword">var</span> machine = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../machine'</span>)
<span class="hljs-keyword">var</span> config = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../config"</span>);
<span class="hljs-keyword">var</span> base = <span class="hljs-built_in">require</span>(<span class="hljs-string">"./test_base"</span>);

describe(<span class="hljs-string">'G2'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>

	it(<span class="hljs-string">'Multi Set'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(done)</span>{</span>
		<span class="hljs-keyword">var</span> expected = {<span class="hljs-string">'carrot'</span>:<span class="hljs-number">3.14</span>};
		base.engine.machine.driver.setMany({<span class="hljs-string">'1tr'</span>:<span class="hljs-number">1</span>,<span class="hljs-string">'2tr'</span>:<span class="hljs-number">2</span>,<span class="hljs-string">'3tr'</span>:<span class="hljs-number">3</span>}, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(err, result)</span> {</span>
			<span class="hljs-keyword">if</span>(err) { done(err); }
			<span class="hljs-keyword">return</span> done();
		});
	});

	it(<span class="hljs-string">'Set a value'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(done)</span>{</span>
		base.engine.machine.driver.set(<span class="hljs-string">'st'</span>, <span class="hljs-number">1</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(err, result)</span> {</span>
			<span class="hljs-keyword">if</span>(err) { done(err); }
			assert.equal(result, <span class="hljs-number">1</span>);
			<span class="hljs-keyword">return</span> done();
		});
	});

	it(<span class="hljs-string">'Set a bogus value'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(done)</span>{</span>
		base.engine.machine.driver.set(<span class="hljs-string">'carrot'</span>, <span class="hljs-number">0.5</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(err, result)</span> {</span>
			<span class="hljs-keyword">if</span>(err) { 
				assert.equal(err.message, <span class="hljs-string">"Timeout"</span>);
				<span class="hljs-keyword">return</span> done();
			}
			<span class="hljs-keyword">else</span> {
                console.log(err.message)
				<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Did not get the expected timeout error from setting an illegal value"</span>)
			}
		});
	});

});</div></div></div></div></body></html>