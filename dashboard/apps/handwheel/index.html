<html>
	<head>
		<link rel="stylesheet" href="./css/style.css">
		<link rel="stylesheet" href="./css/foundation.min.css">
		<link rel="stylesheet" href="./css/normalize.css">
	</head>
	<body>
		<div style="text-align: center">
			<p style="color: black">Rotate the handwheel to drive the tool.</p>
			<canvas width="300" height="300" id="wheel"></canvas>
			<br/>
			<a class="button small" id="xbutton">X</a>
			<a class="button small disabled" id="ybutton">Y</a>
			<a class="button small disabled" id="zbutton">Z</a>
		</div>
	</body>
 
	<script src="./js/jquery-1.10.2.js"></script>
	<script src="./js/foundation.min.js"></script>
	<script src="./js/string-format.js"></script>
	<script src="./js/FabMo-latest.js"></script>
	<script src="./js/FabMo-UI.js"></script>
	<script src="./js/dashboard.js"></script>
	<script src="./js/handwheel.js"></script>

	<script type="text/javascript">
		var machine, ui;
		var mode = 'x';
		var angle = 0.0;
		var SCALE = 0.010;

		var DETENT_ANGLE = 2.0;
		wheel = new HandWheel("wheel", {ppr:32, thumbColor: "#313366", wheelColor:"#DDDDDD"});

		fabmoDashboard.getMachine(function(err, machine) {
			var machine = new FabMo(machine.ip, machine.port);

			wheel.on("sweep", function(evt) {
				var degrees = evt.angle*180.0/Math.PI;
				angle += degrees;
				var distance = Math.abs(angle*SCALE);
				if(angle > 5.0) {
					//console.log(angle);
					angle = 0;
					//console.log(distance);
					machine.fixed_move('+' + mode, distance, function(err) {});
				}
				if(angle < -5.0) {
					//console.log(angle);
					angle = 0;
					//console.log(distance);
					machine.fixed_move('-' + mode, distance, function(err) {});
				}
			});

			wheel.on("release", function(evt) {
				console.log("release");
				machine.quit(function() {})
			});
		});

		$('#xbutton').click(function(evt) {
			$('#xbutton').removeClass('disabled');
			$('#ybutton').addClass('disabled');
			$('#zbutton').addClass('disabled');
			mode = 'x';
		});

		$('#ybutton').click(function(evt) {
			$('#ybutton').removeClass('disabled');
			$('#xbutton').addClass('disabled');
			$('#zbutton').addClass('disabled');
			mode = 'y';
		});

		$('#zbutton').click(function(evt) {
			$('#zbutton').removeClass('disabled');
			$('#xbutton').addClass('disabled');
			$('#ybutton').addClass('disabled');
			mode = 'z';
		});

	</script>
</html>
